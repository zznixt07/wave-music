{% extends 'base.html' %}
{% load static %}

{% block title %}
    Signup - My Site
{% endblock title %}

{% block inline_css %}
    <style >

        section.center {
            display: grid;
            grid-template-columns: 5fr 4fr;
            grid-template-rows: 1fr;
            background-color: #dcd8dd;
            /*color: white;*/
        }
        form {
            /*min-width: 50%;
            max-width: 95%;*/
            width: clamp(250px, 50%, 100%);
            justify-self: center;
        }
        form ul {
            list-style-type: none;
            padding: 0;
        }
        ul li {
            margin: 0.4rem auto;
        }
        .errorlist li {
            margin: 0 auto;
            color: red;
        }
        input, select {
            width: 100%;
            height: 2rem;
        }
        #t-and-c input {
            width: unset;
            height: unset;
        }
        label {
            display: block;
            margin: 0.3rem auto;
        }
        .half-side-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .group-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        .password {position: relative;}

        .password input {padding-right: 20px;}

        .password .toggle-pswd {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
        }
        @media screen and (max-width: 500px) {
            section.center {
                grid-template-columns: 1fr;
            }
            form {
                width: 90%;
            }
            .group-col {

            }
            .half-side-image {
                display: none;
             }
        }
        
    </style>
{% endblock inline_css %}

{% block external_css %}
    <link rel="stylesheet" type="text/css" href="{% static 'account/css/errors.css' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
{% endblock external_css %}

{% block content %}
    <div class="main">
        <section class="center">     
            <form action="" method="POST" novalidate>
                {% csrf_token %}
                {% comment %}{% include 'messages.html' %}{% endcomment %}
                {% comment %}{{ form.as_p }}{% endcomment %}
                
                <div class="text-center">
                    <h2>Hello! Signup</h2>
                    <p>
                        Have an account? <a href="">Log in</a>
                    </p>
                </div>
                <ul>
                    <li>
                        {{ form.email.label_tag }}
                        {{ form.email }}
                        <small>{{ form.email.errors }}</small>
                    </li>
                    <li>
                        {{ form.username.label_tag }}
                        {{ form.username }}
                        <small>{{ form.username.errors }}</small>
                    </li>
                    <li>
                        {{ form.password.label_tag }}
                            <div class="password">
                                {{ form.password }}
                                <i class="toggle-pswd ri-eye-line"></i>
                            </div>
                        <div>
                        <small>{{ form.password.errors }}</small>
                    </li>
                    <li>
                        <div class="group-col">
                            <div>
                                {{ form.first_name.label_tag }}
                                {{ form.first_name }} 
                                <small>{{ form.first_name.errors }}</small>
                            </div>
                            <div>
                                {{ form.last_name.label_tag }}
                                {{ form.last_name }} 
                                <small>{{ form.last_name.errors }}</small>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div>
                            {{ form.country.label_tag }}
                            {{ form.country }} 
                            <small>{{ form.country.errors }}</small>
                        </div>
                    </li>
                    <li>
                        <div class="group-col">
                            <div>
                                {{ form.gender.label_tag }}
                                {{ form.gender }} 
                                <small>{{ form.gender.errors }}</small>
                            </div>
                            <div>
                                {{ form.age.label_tag }}
                                {{ form.age }} 
                                <small>{{ form.age.errors }}</small>
                            </div>
                        </div>
                    </li>
                    <li id="t-and-c">
                        {{ form.accept_t_and_c.label_tag }}Accept <a href="#">terms and conditions</a>
                        {{ form.accept_t_and_c }}
                        <small>{{ form.accept_t_and_c.errors }}</small>
                            
                    </li>
                    <input type="submit" value="Register">
                </ul>
            </form>
            <div class="half-side-image">
                <img src="{% static 'account/imgs/4.jpg' %}">
            </div>
        </section>
    </div>
{% endblock content %}

{% block bottom_js %}
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
    <script type="text/javascript">

        // returns the added class else undefined.
        function toggleClass(elem, cls1, cls2) {
            classes = elem.classList
            if (Array.from(classes).indexOf(cls1) !== -1) {
                classes.remove(cls1)
                classes.add(cls2)
                return cls2
            }
            // below: using if is different than using else
            else {
                classes.remove(cls2)
                classes.add(cls1)
                return cls1
            }
        }

        document.querySelectorAll('.password').forEach((elem) => {
            const toggleBtn = elem.querySelector('.toggle-pswd')
            toggleBtn.onclick = () => {
                const showPswdClass = 'ri-eye-line'
                const hidePswdClass = 'ri-eye-off-line'
                const addedClass = toggleClass(toggleBtn, showPswdClass, hidePswdClass)
                if (addedClass === showPswdClass) {
                    elem.querySelector('input').type = 'password'
                }
                else {
                    elem.querySelector('input').type = 'text'
                }

            }
        })
    </script>
{% endblock bottom_js %}